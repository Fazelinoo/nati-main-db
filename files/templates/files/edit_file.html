{% extends 'core/base.html' %}
{% block title %}ویرایش فایل{% endblock %}
{% block content %}
<style>
  .edit-bg {
    background: #f7f8fa;
    min-height: 100vh;
    padding-top: 32px;
    transition: background 0.2s;
  }
  .card {
    background: #fff;
    color: #222;
    border-radius: 16px;
    box-shadow: 0 2px 16px #b3c6ff22;
    border: 2.5px solid #e3e6ee;
    transition: background 0.2s, color 0.2s, border 0.2s;
  }
  .form-label, .form-check-label {
    font-weight: 500;
  }
  .form-control, .form-check-input {
    background: #f3f4f8;
    color: #222;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    transition: background 0.2s, color 0.2s;
  }
  .role-badge-check {
    display: flex;
    align-items: center;
    gap: 0.5em;
    background: #eaf1ff;
    border-radius: 20px;
    padding: 0.25em 0.9em 0.25em 0.7em;
    font-size: 0.98em;
    font-weight: 500;
    border: 1px solid #c7d6f3;
    cursor: pointer;
    margin-bottom: 2px;
    min-width: 110px;
    min-height: 36px;
    user-select: none;
    transition: background 0.2s, color 0.2s, border 0.2s;
  }
  .role-badge-check input[type="checkbox"] {
    accent-color: #3b82f6;
    margin-right: 0.3em;
    margin-left: 0.1em;
    width: 1.15em;
    height: 1.15em;
    border-radius: 6px;
    border: 2px solid #3b82f6;
    box-shadow: 0 1px 2px #b3c6ff33;
    vertical-align: middle;
    cursor: pointer;
    transition: accent-color 0.2s, border 0.2s;
    background: #fff;
    appearance: auto;
  }
  .role-badge-label {
    color: #2563eb;
    font-weight: 600;
    letter-spacing: 0.01em;
  }
  @media (prefers-color-scheme: dark) {
    .edit-bg {
      background: #181a1b;
    }
    .card {
      background: #23272e;
      color: #e6e6e6;
      box-shadow: 0 2px 16px #0004;
      border: 2.5px solid #444a;
    }
    .form-control, .form-check-input {
      background: #23272e;
      color: #e6e6e6;
      border: 1px solid #444a;
    }
    .form-label, .form-check-label {
      color: #e6e6e6;
    }
    .role-badge-check {
      background: #23272e;
      border: 1px solid #444a;
    }
    .role-badge-label {
      color: #90b4fa;
    }
    .role-badge-check input[type="checkbox"] {
      accent-color: #90b4fa;
      background: #23272e;
      border: 2px solid #90b4fa;
    }
  }
  body[data-bs-theme="dark"] .edit-bg {
    background: #181a1b !important;
  }
  body[data-bs-theme="dark"] .card {
    background: #23272e !important;
    color: #e6e6e6 !important;
    border: 2.5px solid #444a !important;
    box-shadow: 0 2px 16px #0004;
  }
  body[data-bs-theme="dark"] .role-badge-check {
    background: #23272e !important;
    border: 1px solid #444a !important;
  }
  body[data-bs-theme="dark"] .role-badge-label {
    color: #90b4fa !important;
  }
  body[data-bs-theme="dark"] .role-badge-check input[type="checkbox"] {
    accent-color: #90b4fa !important;
    background: #23272e !important;
    border: 2px solid #90b4fa !important;
  }
</style>
<div class="edit-bg">
  <div class="row justify-content-center">
    <div class="col-md-7">
        <div class="card p-4 mt-4">
            <h3 class="mb-3">ویرایش فایل</h3>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form.non_field_errors }}
                <div class="mb-3">
                    <label class="form-label">فایل جدید (در صورت نیاز)</label>
                    {{ form.file }}
                </div>
                <div class="mb-3">
                    <label class="form-label">توضیحات</label>
                    {{ form.description }}
                </div>
                <div class="mb-3">
                    <label class="form-label">سطح دسترسی</label>
                    {{ form.access_level }}
                </div>
                <div class="mb-3">
                  <label class="form-label">نقش‌های مجاز</label>
                  <div class="d-flex flex-wrap gap-2">
                    {% for checkbox in form.allowed_roles %}
                      <label class="role-badge-check">
                        {{ checkbox.tag }}
                        <span class="role-badge-label">{{ checkbox.choice_label }}</span>
                      </label>
                    {% endfor %}
                  </div>
                </div>
                <button type="submit" class="btn btn-primary w-100">ذخیره تغییرات</button>
                <a href="{{ request.GET.next|default:'/' }}" class="btn btn-secondary w-100 mt-2">بازگشت</a>
            </form>
        </div>
    </div>
</div>
{% endblock %}
